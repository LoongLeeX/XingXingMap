# 使用指南

## 🎯 功能概览

这个应用包含以下主要功能：

1. **地图浏览** - 浏览、缩放、平移地图
2. **地址搜索** - 搜索任意地点并定位
3. **标记管理** - 添加、查看、编辑、删除标记
4. **视图切换** - 在 2D、3D 和分屏模式之间切换
5. **卫星视图** - 查看卫星图像

## 📖 使用步骤

### 1. 启动应用

```bash
cd /Users/cocui/i100/kkMy/github/Map
npm run dev
```

访问 http://localhost:3000

### 2. 配置 Google Maps API Key

**重要**: 应用需要 Google Maps API Key 才能正常运行

1. 打开 `.env` 文件
2. 添加你的 API Key:
   ```env
   NEXT_PUBLIC_GOOGLE_MAPS_API_KEY=你的_API_KEY
   ```
3. 重启开发服务器

### 3. 基本操作

#### 搜索地点
- 在顶部搜索栏输入地址或地点名称
- 从下拉建议中选择一个地点
- 地图会自动定位到选中的位置

#### 添加标记
1. 点击地图上的任意位置
2. 在弹出的表单中填写标题和描述
3. 点击"保存"按钮

#### 查看标记列表
- 左侧边栏显示所有标记
- 点击标记卡片可在地图上定位
- 点击"删除"按钮可删除标记

#### 切换视图模式
- 点击顶部的视图模式按钮:
  - **2D 视图**: 传统 2D 地图
  - **3D 视图**: 真实感 3D 地图
  - **分屏对比**: 同时显示 2D 和 3D 视图

#### 切换地图类型
- 点击视图模式下方的地图类型按钮:
  - **地图**: 道路地图
  - **卫星**: 卫星图像
  - **混合**: 卫星图像 + 标注
  - **地形**: 地形图

## 🔧 功能详解

### 地图控制

| 操作 | 说明 |
|------|------|
| 拖动 | 按住鼠标左键拖动地图 |
| 缩放 | 使用滚轮或右下角的 +/- 按钮 |
| 双击 | 放大一级并居中 |

### 标记管理

**标记包含的信息**:
- 标题（必填，最多 200 字）
- 描述（可选，最多 2000 字）
- 位置坐标（自动记录）
- 创建时间（自动记录）

**操作**:
- **查看**: 点击标记卡片
- **定位**: 点击标记会在地图上定位
- **删除**: 点击"删除"按钮（需确认）

### 搜索功能

支持搜索的类型:
- 地址（如：北京市朝阳区建国路）
- 地点名称（如：天安门广场）
- POI（如：星巴克）
- 坐标（如：39.9042, 116.4074）

### 3D 地图

**要求**:
- 需要配置 `NEXT_PUBLIC_GOOGLE_MAPS_MAP_ID`
- 仅部分城市支持 3D 视图
- 需要较好的网络连接

**控制**:
- **旋转**: 按住 Ctrl + 拖动
- **倾斜**: 按住 Shift + 拖动
- **缩放**: 滚轮

## 📱 键盘快捷键

| 快捷键 | 功能 |
|--------|------|
| Esc | 关闭弹窗 |
| +/- | 缩放地图 |
| 方向键 | 平移地图 |

## 💡 使用技巧

### 1. 快速定位

在搜索栏输入坐标可以直接定位:
```
39.9042, 116.4074
```

### 2. 查看标记详情

点击标记卡片可以:
- 在地图上定位到该标记
- 查看完整的描述信息
- 查看创建时间

### 3. 分屏对比

分屏模式特别适合:
- 对比 2D 和 3D 视图
- 查看同一位置的不同角度
- 两个地图可以独立操作

### 4. 批量管理

使用左侧边栏可以:
- 查看所有标记
- 统计标记数量
- 快速定位到任意标记

## 🐛 常见问题

### Q: 地图不显示？
A: 检查 Google Maps API Key 是否正确配置

### Q: 3D 视图不工作？
A: 
1. 确保配置了 `NEXT_PUBLIC_GOOGLE_MAPS_MAP_ID`
2. 检查当前位置是否支持 3D 视图
3. 尝试切换到支持 3D 的大城市（如北京、上海）

### Q: 搜索没有结果？
A: 
1. 确保 Places API 已启用
2. 检查网络连接
3. 尝试使用更具体的搜索词

### Q: 标记保存失败？
A: 
1. 检查数据库是否正常运行
2. 查看浏览器控制台的错误信息
3. 确保标题不为空

## 🔍 数据查看

### 使用 Prisma Studio

```bash
npx prisma studio
```

访问 http://localhost:5555 可以:
- 查看所有标记数据
- 直接编辑数据
- 删除或添加记录

### 使用 SQLite CLI

```bash
sqlite3 dev.db

# 查看所有标记
SELECT * FROM markers;

# 统计标记数量
SELECT COUNT(*) FROM markers;

# 查看最新的 5 个标记
SELECT * FROM markers ORDER BY createdAt DESC LIMIT 5;
```

## 🎨 自定义

### 修改默认位置

编辑 `clientservershare/constants/map.constants.ts`:

```typescript
export const DEFAULT_MAP_CONFIG: MapConfig = {
  center: {
    lat: 你的纬度,
    lng: 你的经度,
  },
  zoom: 12,
  mapType: 'roadmap',
};
```

### 修改主题颜色

编辑 `tailwind.config.js` 中的 `primary` 颜色。

## 📚 更多资源

- [Google Maps JavaScript API 文档](https://developers.google.com/maps/documentation/javascript)
- [项目架构说明](doc/plan/1.md)
- [安装指南](INSTALL.md)
- [README](README.md)

## 🆘 获取帮助

如果遇到问题:

1. 查看浏览器控制台的错误信息
2. 查看终端的服务器日志
3. 参考本文档的"常见问题"部分
4. 查看项目文档了解更多细节

---

**开发环境**: macOS  
**浏览器推荐**: Chrome, Edge, Safari (最新版本)  
**最后更新**: 2025-10-03

